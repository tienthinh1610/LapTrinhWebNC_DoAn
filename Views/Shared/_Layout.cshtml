<!DOCTYPE html>
<html lang="vi">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>THINHSHOP | Giày Thể Thao Chính Hãng & Độc Đáo</title>
    <!-- Tải Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Tải Bootstrap CSS (BẮT BUỘC cho Carousel) -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Tải Font Awesome cho icons -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css" rel="stylesheet">
    
    <!-- Cấu hình Tailwind -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'primary-blue': '#1e40af', // Xanh đậm mạnh mẽ
                        'secondary-orange': '#f97316', // Cam nổi bật cho CTA
                        'base-gray': '#f3f4f6',
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    <style>
        .carousel-indicators [data-bs-target] {
            background-color: #1e40af;
        }
        .carousel-control-prev, .carousel-control-next {
            width: 10%;
        }
    </style>
</head>
<body class="bg-base-gray font-sans min-h-screen flex flex-col">

    <!-- HEADER: Thanh điều hướng dính -->
    <header class="sticky top-0 bg-white shadow-md z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-3">
            <div class="flex justify-between items-center h-16">
                
                <!-- Logo/Tên Shop -->
                <a class="text-3xl font-extrabold tracking-tight text-primary-blue hover:text-secondary-orange transition duration-200" href="/">
                    THINH<span class="text-secondary-orange">SHOP</span>
                </a>
                
                <!-- Trung tâm: Thanh tìm kiếm (Tùy chọn) -->
                <div class="hidden md:block flex-1 max-w-md mx-8">
                    <form action="/Search" method="get" class="relative">
                        <input type="text" name="q" placeholder="Tìm kiếm giày thể thao, thương hiệu..." 
                               class="w-full py-2 pl-10 pr-4 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-primary-blue" />
                        <button type="submit" class="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400">
                            <i class="fas fa-search"></i>
                        </button>
                    </form>
                </div>

                <!-- Khu vực Identity & Giỏ hàng -->
                <div class="flex items-center space-x-4">
                    
                    <!-- 1. Trạng thái Đăng nhập/Đăng ký (ĐÃ SỬA LỖI LOGIC) -->
                    <div class="flex items-center space-x-2 text-sm">
                        @{
                            // --- ĐÃ SỬA: Kiểm tra trạng thái đăng nhập THỰC TẾ ---
                            if (User.Identity.IsAuthenticated) {
                                // Nếu đã đăng nhập: Hiển thị Tên và nút Logout
                                // User.Identity.Name sẽ lấy Tên đăng nhập (UserName) hoặc FullName tùy vào cách bạn cấu hình Claims
                                string userName = User.Identity.Name ?? "Khách hàng";
                                
                                <a href="/Identity/Account/Manage" class="px-3 py-1.5 text-sm font-medium text-gray-600 hover:text-primary-blue rounded-full transition duration-200">
                                    <i class="fas fa-user-circle mr-1"></i> Xin chào, @userName
                                </a>
                                <form asp-area="Identity" asp-page="/Account/Logout" asp-route-returnUrl="/" method="post" class="inline">
                                    <button type="submit" class="px-3 py-1.5 text-sm font-medium bg-secondary-orange text-white hover:bg-orange-600 rounded-full transition duration-200 shadow-md">
                                        <i class="fas fa-sign-out-alt"></i> Đăng xuất
                                    </button>
                                </form>
                            } else {
                                <!-- NÚT ĐĂNG NHẬP -->
                                <a asp-area="Identity" asp-page="/Account/Login" class="px-3 py-1.5 text-sm font-medium text-primary-blue hover:bg-primary-blue hover:text-white rounded-full transition duration-200 border border-primary-blue">
                                    <i class="fas fa-sign-in-alt"></i> Đăng nhập
                                </a>
                                <!-- NÚT ĐĂNG KÝ -->
                                <a asp-area="Identity" asp-page="/Account/Register" class="px-3 py-1.5 text-sm font-medium bg-secondary-orange text-white hover:bg-orange-600 rounded-full transition duration-200 shadow-lg">
                                    <i class="fas fa-user-plus"></i> Đăng ký
                                </a>
                            }
                        }
                    </div>
                    
                    <!-- 2. Giỏ hàng (View Component Cart Summary) -->
                    <div class="relative">
                        <vc:cart-summary />
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- NAVIGATION MENU: Thanh danh mục chính -->
    <nav class="bg-white border-b border-gray-200 shadow-sm">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-12">
                <vc:navigation-menu />
            </div>
        </div>
    </nav>
    
    <!-- MAIN CONTENT: Carousel và Khu vực RenderBody -->
    <main class="flex-grow max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
        
        <!-- CAROUSEL BANNER -->
        <div id="productBannerCarousel" class="carousel slide carousel-fade mb-6 rounded-xl shadow-lg overflow-hidden" data-bs-ride="carousel" data-bs-interval="4000">
            <div class="carousel-indicators">
                <button type="button" data-bs-target="#productBannerCarousel" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
                <button type="button" data-bs-target="#productBannerCarousel" data-bs-slide-to="1" aria-label="Slide 2"></button>
                <button type="button" data-bs-target="#productBannerCarousel" data-bs-slide-to="2" aria-label="Slide 3"></button>
                <button type="button" data-bs-target="#productBannerCarousel" data-bs-slide-to="3" aria-label="Slide 4"></button>
                <button type="button" data-bs-target="#productBannerCarousel" data-bs-slide-to="4" aria-label="Slide 5"></button>
            </div>
            <div class="carousel-inner">
                <div class="carousel-item active">
                    <img src="/images/bn1.jpg" class="w-full h-auto object-cover" alt="Banner 1" style="max-height: 400px;">
                </div>
                <div class="carousel-item">
                    <img src="/images/bn2.webp" class="w-full h-auto object-cover" alt="Banner 2" style="max-height: 400px;">
                </div>
                <div class="carousel-item">
                    <img src="/images/bn3.jpg" class="w-full h-auto object-cover" alt="Banner 3" style="max-height: 400px;">
                </div>
                <div class="carousel-item">
                    <img src="/images/bn4.jpg" class="w-full h-auto object-cover" alt="Banner 4" style="max-height: 400px;">
                </div>
                <div class="carousel-item">
                    <img src="/images/bn5.jpg" class="w-full h-auto object-cover" alt="Banner 5" style="max-height: 400px;">
                </div>
            </div>
            <!-- Các nút điều khiển Carousel -->
            <button class="carousel-control-prev" type="button" data-bs-target="#productBannerCarousel" data-bs-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Previous</span>
            </button>
            <button class="carousel-control-next" type="button" data-bs-target="#productBannerCarousel" data-bs-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Next</span>
            </button>
        </div>
        
        <!-- Khu vực nội dung chính -->
        <div class="mt-8">
            @RenderBody() 
        </div>

    </main>

    <!-- FOOTER -->
    <footer class="mt-auto bg-gray-800 text-white border-t border-gray-700">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-10">
            <div class="grid grid-cols-2 md:grid-cols-4 gap-8">
                <!-- Cột 1: Logo và Mô tả -->
                <div>
                    <h4 class="text-2xl font-bold mb-3 text-secondary-orange">THINHSHOP</h4>
                    <p class="text-gray-400 text-sm">Chuyên cung cấp giày thể thao chính hãng, thời trang và độc đáo.</p>
                    <div class="flex space-x-4 mt-3">
                        <a href="#" class="text-gray-400 hover:text-white"><i class="fab fa-facebook-f"></i></a>
                        <a href="#" class="text-gray-400 hover:text-white"><i class="fab fa-instagram"></i></a>
                        <a href="#" class="text-gray-400 hover:text-white"><i class="fab fa-twitter"></i></a>
                    </div>
                </div>
                <!-- Cột 2: Dịch vụ Khách hàng -->
                <div>
                    <h4 class="text-lg font-semibold mb-4 border-b border-secondary-orange pb-1">Hỗ trợ</h4>
                    <ul class="space-y-2 text-sm">
                        <li><a href="#" class="text-gray-400 hover:text-white transition">Trung tâm trợ giúp</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white transition">Chính sách đổi trả</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white transition">Vận chuyển & Giao hàng</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white transition">Liên hệ</a></li>
                    </ul>
                </div>
                <!-- Cột 3: Thông tin Cửa hàng -->
                <div>
                    <h4 class="text-lg font-semibold mb-4 border-b border-secondary-orange pb-1">Cửa hàng</h4>
                    <ul class="space-y-2 text-sm">
                        <li><a href="#" class="text-gray-400 hover:text-white transition">Về chúng tôi</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white transition">Tuyển dụng</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white transition">Blog</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white transition">Bản đồ trang web</a></li>
                    </ul>
                </div>
                <!-- Cột 4: Đăng ký nhận tin -->
                <div>
                    <h4 class="text-lg font-semibold mb-4 border-b border-secondary-orange pb-1">Nhận ưu đãi mới nhất</h4>
                    <p class="text-gray-400 text-sm mb-3">Đăng ký để nhận các chương trình giảm giá độc quyền.</p>
                    <input type="email" placeholder="Nhập email của bạn" class="w-full p-2 rounded-lg text-gray-900 focus:outline-none" />
                    <button class="w-full mt-2 bg-secondary-orange text-white py-2 rounded-lg font-semibold hover:bg-orange-600 transition duration-200">Đăng ký</button>
                </div>
            </div>
        </div>
        
        <!-- Bản quyền -->
        <div class="bg-gray-900 py-3 text-center text-gray-500 text-sm">
            &copy; 2025 THINHSHOP.VN | Thiết kế và Phát triển bởi THINHSHOP Team.
        </div>
    </footer>

    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.15.0/Sortable.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            var el = document.getElementById('draggable-menu');
            if (el) {
                var sortable = new Sortable(el, {
                    animation: 150,
                    ghostClass: 'bg-primary-blue/30', 
                    onEnd: function (evt) {
                        console.log('Thứ tự danh mục đã được thay đổi:', evt.newIndex);
                    },
                });
            }
            
            // Khởi tạo Bootstrap Carousel bằng tay
            var carouselElement = document.getElementById('productBannerCarousel');
            if (carouselElement) {
                new bootstrap.Carousel(carouselElement, {
                    interval: 4000,
                    ride: 'carousel'
                });
            }
        });
    </script>
    @RenderSection("Scripts", required: false)
</body>
</html>